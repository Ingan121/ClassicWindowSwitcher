name: Build

on: [push]

jobs:
  build:
    runs-on: windows-2025

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      
    - name: Declare some variables
      id: vars
      shell: bash
      run: |
          branch=$(echo ${GITHUB_REF#refs/heads/})
          sha_short=$(git rev-parse --short HEAD)
          echo "branch=${branch}" >> $GITHUB_OUTPUT
          echo "sha_short=${sha_short}" >> $GITHUB_OUTPUT

    - name: Add MSBuild to PATH
      uses: microsoft/setup-msbuild@v2

    - name: Build
      working-directory: ${{env.GITHUB_WORKSPACE}}
      # Add additional options to the MSBuild command line here (like platform or verbosity level).
      # See https://docs.microsoft.com/visualstudio/msbuild/msbuild-command-line-reference
      run: msbuild /m /p:Configuration=Release /p:Platform=x64 SimpleWindowSwitcher.sln
      
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: sws_bin_amd64_${{ steps.vars.outputs.sha_short }}_${{ steps.vars.outputs.branch }}
        path: |
          x64/Release/
